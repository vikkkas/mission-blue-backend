// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  mobile    String?  @unique
  email     String?  @unique
  name      String?
  isVerified Boolean @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  sessions  Session[]
  passwordHash String?
  verificationTokens VerificationToken[]
  profile   Profile?

  @@index([mobile])
  @@index([email])
}

model VerificationToken {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  token     String   @unique
  type      TokenType
  expiresAt DateTime
  used      Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([userId, type])
  @@index([token])
}

enum TokenType {
  VERIFY_EMAIL
  RESET_PASSWORD
}

model Session {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  token     String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([userId])
  @@index([token])
}

model Profile {
  id           String   @id @default(cuid())
  userId       String   @unique
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  fullName     String
  dob          DateTime
  gender       String
  nationality  String
  passport     String?
  email        String
  mobile       String
  altMobile    String?
  address      String
  pincode      String
  organization String
  designation  String
  industry     String
  linkedin     String?
  referral     String?
  volunteer    String?
  interests    String[] @default([])
  termsConsent Boolean
  mediaConsent Boolean
  dataConsent  Boolean
  photoUrl     String?
  idProofUrl   String?
  studentIdUrl String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([userId])
}
